# vite-plugin-html-srcset


ğŸ‰ Vite Plugin HTML Srcset  
============================================================
ğŸ“ Total files: 180
ğŸ“¦ Total size: 159.2 KB
ğŸ—œï¸  Archive: \tmp\vite-plugin-html-srcset.zip
ğŸ“Š Archive size: 113.5 KB

ğŸ“‹ File Breakdown:
  .avif          7 files
  .css           2 files
  .html          7 files
  .jpg          16 files
  .js            3 files
  .json          5 files
  .md            3 files
  .png          11 files
  .sample       14 files
  .svg           3 files
  .ts           11 files
  .webp         12 files
  .yaml          1 files
  no extension  85 files

ğŸ—ï¸  Project Structure:
â”œâ”€â”€ .git/
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ applypatch-msg.sample
â”‚   â”‚   â”œâ”€â”€ commit-msg.sample
â”‚   â”‚   â”œâ”€â”€ fsmonitor-watchman.sample
â”‚   â”‚   â”œâ”€â”€ post-update.sample
â”‚   â”‚   â”œâ”€â”€ pre-applypatch.sample
â”‚   â”‚   â”œâ”€â”€ pre-commit.sample
â”‚   â”‚   â”œâ”€â”€ pre-merge-commit.sample
â”‚   â”‚   â”œâ”€â”€ pre-push.sample
â”‚   â”‚   â”œâ”€â”€ pre-rebase.sample
â”‚   â”‚   â”œâ”€â”€ pre-receive.sample
â”‚   â”‚   â”œâ”€â”€ prepare-commit-msg.sample
â”‚   â”‚   â”œâ”€â”€ push-to-checkout.sample
â”‚   â”‚   â”œâ”€â”€ sendemail-validate.sample
â”‚   â”‚   â””â”€â”€ update.sample
â”‚   â”œâ”€â”€ info/
â”‚   â”‚   â””â”€â”€ exclude
â”‚   â”œâ”€â”€ logs/
â”‚   â”‚   â”œâ”€â”€ refs/
â”‚   â”‚   â””â”€â”€ HEAD
â”‚   â”œâ”€â”€ objects/
â”‚   â”‚   â”œâ”€â”€ 01/
â”‚   â”‚   â”œâ”€â”€ 04/
â”‚   â”‚   â”œâ”€â”€ 0a/
â”‚   â”‚   â”œâ”€â”€ 0d/
â”‚   â”‚   â”œâ”€â”€ 0f/
â”‚   â”‚   â”œâ”€â”€ 15/
â”‚   â”‚   â”œâ”€â”€ 17/
â”‚   â”‚   â”œâ”€â”€ 19/
â”‚   â”‚   â”œâ”€â”€ 23/
â”‚   â”‚   â”œâ”€â”€ 28/
â”‚   â”‚   â”œâ”€â”€ 2d/
â”‚   â”‚   â”œâ”€â”€ 39/
â”‚   â”‚   â”œâ”€â”€ 3c/
â”‚   â”‚   â”œâ”€â”€ 45/
â”‚   â”‚   â”œâ”€â”€ 46/
â”‚   â”‚   â”œâ”€â”€ 4b/
â”‚   â”‚   â”œâ”€â”€ 4c/
â”‚   â”‚   â”œâ”€â”€ 4e/
â”‚   â”‚   â”œâ”€â”€ 51/
â”‚   â”‚   â”œâ”€â”€ 55/
â”‚   â”‚   â”œâ”€â”€ 58/
â”‚   â”‚   â”œâ”€â”€ 5f/
â”‚   â”‚   â”œâ”€â”€ 63/
â”‚   â”‚   â”œâ”€â”€ 66/
â”‚   â”‚   â”œâ”€â”€ 67/
â”‚   â”‚   â”œâ”€â”€ 6a/
â”‚   â”‚   â”œâ”€â”€ 6b/
â”‚   â”‚   â”œâ”€â”€ 70/
â”‚   â”‚   â”œâ”€â”€ 71/
â”‚   â”‚   â”œâ”€â”€ 83/
â”‚   â”‚   â”œâ”€â”€ 86/
â”‚   â”‚   â”œâ”€â”€ 88/
â”‚   â”‚   â”œâ”€â”€ 94/
â”‚   â”‚   â”œâ”€â”€ 96/
â”‚   â”‚   â”œâ”€â”€ 98/
â”‚   â”‚   â”œâ”€â”€ 9b/
â”‚   â”‚   â”œâ”€â”€ 9e/
â”‚   â”‚   â”œâ”€â”€ a1/
â”‚   â”‚   â”œâ”€â”€ af/
â”‚   â”‚   â”œâ”€â”€ bb/
â”‚   â”‚   â”œâ”€â”€ bf/
â”‚   â”‚   â”œâ”€â”€ c3/
â”‚   â”‚   â”œâ”€â”€ c9/
â”‚   â”‚   â”œâ”€â”€ ce/
â”‚   â”‚   â”œâ”€â”€ cf/
â”‚   â”‚   â”œâ”€â”€ d2/
â”‚   â”‚   â”œâ”€â”€ d9/
â”‚   â”‚   â”œâ”€â”€ e9/
â”‚   â”‚   â”œâ”€â”€ eb/
â”‚   â”‚   â”œâ”€â”€ ef/
â”‚   â”‚   â”œâ”€â”€ f3/
â”‚   â”‚   â”œâ”€â”€ f7/
â”‚   â”‚   â”œâ”€â”€ f9/
â”‚   â”‚   â”œâ”€â”€ fa/
â”‚   â”‚   â”œâ”€â”€ fc/
â”‚   â”‚   â”œâ”€â”€ fe/
â”‚   â”‚   â”œâ”€â”€ info/
â”‚   â”‚   â””â”€â”€ pack/
â”‚   â”œâ”€â”€ refs/
â”‚   â”‚   â”œâ”€â”€ heads/
â”‚   â”‚   â”œâ”€â”€ remotes/
â”‚   â”‚   â””â”€â”€ tags/
â”‚   â”œâ”€â”€ COMMIT_EDITMSG
â”‚   â”œâ”€â”€ config
â”‚   â”œâ”€â”€ description
â”‚   â”œâ”€â”€ FETCH_HEAD
â”‚   â”œâ”€â”€ HEAD
â”‚   â”œâ”€â”€ index
â”‚   â””â”€â”€ ORIG_HEAD
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ api.md
â”‚   â””â”€â”€ contributing.md
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ advanced/
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ about.html
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ products.html
â”‚   â”‚   â”œâ”€â”€ styles.css
â”‚   â”‚   â””â”€â”€ vite.config.js
â”‚   â””â”€â”€ basic/
â”‚       â”œâ”€â”€ public/
â”‚       â”œâ”€â”€ index.html
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ vite.config.js
â”œâ”€â”€ playground/
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ images/
â”‚   â”œâ”€â”€ blog.html
â”‚   â”œâ”€â”€ gallery.html
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ style.css
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ image-processor.ts
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ plugin.ts
â”‚   â””â”€â”€ types.ts
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ image-processor.test.ts
â”‚   â”œâ”€â”€ integration.test.ts
â”‚   â”œâ”€â”€ plugin.test.ts
â”‚   â””â”€â”€ types.test.ts
â”œâ”€â”€ .gitignore
â”œâ”€â”€ client.d.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ README.md
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsup.config.ts
â””â”€â”€ vitest.config.ts

âœ… Key Features Implemented:
  âœ¨ Complete Vite 7 plugin with TypeScript
  ğŸ–¼ï¸  HTML processing for img, picture, and figure tags
  ğŸ“± Responsive image generation with Sharp
  ğŸ¨ Multiple format support (PNG, WebP, AVIF, JPEG)
  âš™ï¸  Configurable options and settings
  ğŸ§ª Comprehensive test suite with Vitest
  ğŸ“Š V8 coverage reporting
  ğŸ® Interactive playground
  ğŸ“š Basic and advanced examples
  ğŸ“– Complete documentation
  ğŸ—ï¸  Monorepo structure with pnpm
  ğŸ¯ TypeScript definitions
  ğŸ”§ Build configuration with tsup

ğŸ’¾ Archive created: \tmp\vite-plugin-html-srcset.zip

A Vite 7 plugin that automatically processes HTML files and transforms `<img>`, `<picture>`, and `<figure>` tags with srcset attributes for responsive images.

## Features

- ğŸ–¼ï¸ **Automatic Image Processing**: Transforms images with `?srcset` suffix during build
- ğŸ“± **Responsive Images**: Generates multiple image sizes automatically
- ğŸ¨ **Multiple Formats**: Supports PNG, WebP, AVIF, and JPEG
- âš¡ **Vite 7 Compatible**: Built specifically for Vite 7
- ğŸ”§ **Configurable**: Flexible configuration options
- ğŸ“‹ **Full Coverage**: Comprehensive test suite with Vitest and V8 coverage
- ğŸ® **Playground**: Interactive examples and demos


## Installation

```bash
pnpm add -D vite-plugin-html-srcset
```

## Quick Start

### 1. Configure the plugin

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import htmlSrcsetPlugin from 'vite-plugin-html-srcset'

export default defineConfig({
  plugins: [
    htmlSrcsetPlugin({
      outputWidths: [320, 640, 768, 1024, 1280, 1600],
      outputFormats: {
        webp: true,
        avif: true,
        jpeg: true,
        png: true
      },
      quality: 85
    })
  ]
})
```

### 2. Use in your HTML

Simply add `?srcset` to any image src attribute:

```html
<!-- Basic img tag -->
<img src="/hero-image.jpg?srcset" alt="Hero image" />

<!-- Picture element -->
<picture>
  <source srcset="/modern-image.avif?srcset" type="image/avif">
  <source srcset="/modern-image.webp?srcset" type="image/webp">
  <img src="/modern-image.jpg?srcset" alt="Modern image" />
</picture>

<!-- Figure element -->
<figure>
  <img src="/gallery-image.png?srcset" alt="Gallery image" />
  <figcaption>Image caption</figcaption>
</figure>
```

### 3. Build your project

```bash
pnpm run build
```

The plugin will automatically:
- Generate multiple image sizes
- Create optimized formats (WebP, AVIF, etc.)
- Update HTML with proper `srcset` attributes
- Remove the `?srcset` suffix from URLs

## Configuration Options

```typescript
interface HtmlSrcsetOptions {
  /**
   * Include patterns for HTML files to process
   * @default ['**/*.html']
   */
  include?: string[]

  /**
   * Exclude patterns for HTML files to skip
   * @default []
   */
  exclude?: string[]

  /**
   * Output image formats
   * @default { png: true, webp: true, avif: false, jpeg: true }
   */
  outputFormats?: {
    png?: boolean
    webp?: boolean
    avif?: boolean
    jpeg?: boolean
  }

  /**
   * Output image widths
   * @default [320, 640, 768, 1024, 1280, 1600]
   */
  outputWidths?: number[]

  /**
   * Prefix for generated asset names
   * @default ''
   */
  assetNamePrefix?: string

  /**
   * Image quality (1-100)
   * @default 80
   */
  quality?: number
}
```

## Examples

### Basic Usage
```bash
cd examples/basic
pnpm install
pnpm run dev
```

### Advanced Usage
```bash
cd examples/advanced
pnpm install
pnpm run dev
```

### Playground
```bash
cd playground
pnpm install
pnpm run dev
```

## Development

### Setup
```bash
pnpm install
```

### Build
```bash
pnpm run build
```

### Test
```bash
# Run tests
pnpm run test

# Run tests with coverage
pnpm run test:coverage

# Run tests with UI
pnpm run test:ui
```

### Playground
```bash
pnpm run playground
```

## How It Works

1. **Build Time Processing**: The plugin only runs during the build process (`apply: 'build'`)
2. **HTML Transformation**: Uses the `transformIndexHtml` hook to process HTML files
3. **Image Detection**: Finds all `<img>`, `<picture>`, and `<figure>` tags with `?srcset` suffix
4. **Image Generation**: Uses Sharp to generate multiple sizes and formats
5. **HTML Update**: Replaces original tags with responsive `srcset` attributes

## Supported Image Formats

- **Input**: JPEG, PNG, WebP, AVIF, GIF, SVG
- **Output**: PNG, WebP, AVIF, JPEG (configurable)

## Browser Support

The plugin generates modern image formats with proper fallbacks:
- **AVIF**: Modern browsers with best compression
- **WebP**: Wide browser support with good compression
- **JPEG/PNG**: Universal fallback support

## TypeScript Support

Full TypeScript support with type definitions included.

```typescript
import type { HtmlSrcsetOptions } from 'vite-plugin-html-srcset'
```

## Performance Tips

1. **Use appropriate widths**: Don't generate more sizes than needed
2. **Choose formats wisely**: AVIF for best compression, WebP for compatibility
3. **Optimize quality**: Balance file size and visual quality (80-90 recommended)
4. **Use proper sizes attribute**: Help browsers select the right image

## License

MIT

## Contributing

Contributions are welcome! Please read our contributing guidelines and ensure all tests pass.

```bash
# Run tests before contributing
pnpm run test:coverage
```